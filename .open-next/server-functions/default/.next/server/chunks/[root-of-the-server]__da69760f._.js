module.exports=[70406,(e,t,a)=>{t.exports=e.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},18622,(e,t,a)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(e,t,a)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(e,t,a)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},24725,(e,t,a)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},93695,(e,t,a)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},37037,e=>{"use strict";let t=Symbol.for("__cloudflare-context__");function a(){return globalThis[t]}async function r(){let e=a();if(e)return e;{var r;let e=await n();return r=e,globalThis[t]=r,e}}async function n(e){let{getPlatformProxy:t}=await import(`${"__wrangler".replaceAll("_","")}`),a=e?.environment??process.env.NEXT_DEV_WRANGLER_ENV,{env:r,cf:n,ctx:s}=await t({...e,envFiles:[],environment:a});return{env:r,cf:n,ctx:s}}async function s(){let{env:e}=await function(e={async:!1}){return e.async?r():function(){let e,t=a();if(t)return t;if(e=globalThis,e.__NEXT_DATA__?.nextExport===!0)throw Error("\n\nERROR: `getCloudflareContext` has been called in sync mode in either a static route or at the top level of a non-static one, both cases are not allowed but can be solved by either:\n  - make sure that the call is not at the top level and that the route is not static\n  - call `getCloudflareContext({async: true})` to use the `async` mode\n  - avoid calling `getCloudflareContext` in the route\n");throw Error('\n\nERROR: `getCloudflareContext` has been called without having called `initOpenNextCloudflareForDev` from the Next.js config file.\nYou should update your Next.js config file as shown below:\n\n   ```\n   // next.config.mjs\n\n   import { initOpenNextCloudflareForDev } from "@opennextjs/cloudflare";\n\n   initOpenNextCloudflareForDev();\n\n   const nextConfig = { ... };\n   export default nextConfig;\n   ```\n\n')}()}();return e}async function i(){return(await s()).DB}e.s(["getDB",()=>i],37037)},91990,e=>{"use strict";let t="https://waterservices.usgs.gov/nwis",a="https://hydro.nationalmap.gov/arcgis/rest/services";async function r(e,a,r,n){let s=`${e},${a},${r},${n}`,i=`${t}/site/?format=rdb&bBox=${s}&siteOutput=expanded&siteStatus=active&siteType=ST&hasDataTypeCd=iv`,o=await fetch(i);if(!o.ok)throw Error(`USGS API error: ${o.status}`);return d(await o.text())}async function n(e){let a=`${t}/site/?format=rdb&huc=${e}&siteOutput=expanded&siteStatus=active&siteType=ST&hasDataTypeCd=iv`,r=await fetch(a);if(!r.ok)throw Error(`USGS API error: ${r.status}`);return d(await r.text())}async function s(e,a=["00060","00065","00010"]){let r=e.join(","),n=a.join(","),i=`${t}/iv/?format=json&sites=${r}&parameterCd=${n}&siteStatus=all`,o=await fetch(i);if(!o.ok)throw Error(`USGS API error: ${o.status}`);return function(e){let t=new Map;if(!e.value?.timeSeries)return[];for(let a of e.value.timeSeries){let e=a.sourceInfo.siteCode[0]?.value,r=a.variable.variableCode[0]?.value;if(e&&a.values[0]?.value)for(let n of a.values[0].value){let a=`${e}_${n.dateTime}`;t.has(a)||t.set(a,{siteId:e,timestamp:n.dateTime,dischargeCfs:null,gageHeightFt:null,waterTempCelsius:null,dissolvedOxygenMgL:null,ph:null,specificConductance:null,turbidityNtu:null});let s=t.get(a),i=parseFloat(n.value);if(!isNaN(i))switch(r){case"00060":s.dischargeCfs=i;break;case"00065":s.gageHeightFt=i;break;case"00010":s.waterTempCelsius=i;break;case"00300":s.dissolvedOxygenMgL=i;break;case"00400":s.ph=i;break;case"00095":s.specificConductance=i;break;case"63680":s.turbidityNtu=i}}}return Array.from(t.values())}(await o.json())}async function i(e,t){let r=`${a}/wbd/MapServer/6/query?geometry=${t},${e}&geometryType=esriGeometryPoint&inSR=4326&spatialRel=esriSpatialRelIntersects&outFields=*&returnGeometry=true&f=geojson`,n=await fetch(r);if(!n.ok)throw Error(`USGS NHD API error: ${n.status}`);let s=await n.json();if(!s.features||0===s.features.length)return null;let i=s.features[0],o=i.properties,l=o.huc12||o.HUC12;return{huc12:l,huc10:l.substring(0,10),huc8:l.substring(0,8),huc6:l.substring(0,6),huc4:l.substring(0,4),huc2:l.substring(0,2),name:o.name||o.NAME,areaSqKm:o.areasqkm||o.AREASQKM||0,states:o.states||o.STATES||"",centroidLat:e,centroidLng:t,boundaryGeoJson:i.geometry}}async function o(e){let t=`${a}/wbd/MapServer/6/query?where=HUC12='${e}'&outFields=*&returnGeometry=true&f=geojson`,r=await fetch(t);if(!r.ok)throw Error(`USGS NHD API error: ${r.status}`);let n=await r.json();if(!n.features||0===n.features.length)return null;let s=n.features[0],i=s.properties,o=function(e){let t=0,a=0,r=0;function n(e){for(let n of e)a+=n[0],t+=n[1],r++}if("Polygon"===e.type)n(e.coordinates[0]);else if("MultiPolygon"===e.type)for(let t of e.coordinates)n(t[0]);return{lat:r>0?t/r:0,lng:r>0?a/r:0}}(s.geometry),l=i.huc12||i.HUC12;return{huc12:l,huc10:l.substring(0,10),huc8:l.substring(0,8),huc6:l.substring(0,6),huc4:l.substring(0,4),huc2:l.substring(0,2),name:i.name||i.NAME,areaSqKm:i.areasqkm||i.AREASQKM||0,states:i.states||i.STATES||"",centroidLat:o.lat,centroidLng:o.lng,boundaryGeoJson:s.geometry}}async function l(e){let t=`${a}/wbd/MapServer/6/query?where=TOHUC='${e}'&outFields=HUC12&returnGeometry=false&f=json`,r=await fetch(t);if(!r.ok)throw Error(`USGS NHD API error: ${r.status}`);return(await r.json()).features.map(e=>e.attributes.HUC12)}async function u(e,t,r,n){let s=`${e},${t},${r},${n}`,i=`${a}/nhd/MapServer/6/query?geometry=${s}&geometryType=esriGeometryEnvelope&inSR=4326&spatialRel=esriSpatialRelIntersects&outFields=GNIS_NAME,LENGTHKM,FCODE,STREAMORDE&returnGeometry=true&f=geojson`,o=await fetch(i);if(!o.ok)throw Error(`USGS NHD API error: ${o.status}`);return await o.json()}function d(e){let t=e.split("\n"),a=[],r=-1,n=[];for(let e=0;e<t.length;e++){let s=t[e].trim();if(s.startsWith("#")||""===s)continue;if(-1===r){n=s.split("	"),r=e;continue}if(s.match(/^[\d\-s]+$/))continue;let i=s.split("	"),o={};n.forEach((e,t)=>{o[e]=i[t]||""}),o.site_no&&a.push({siteId:o.site_no,siteName:o.station_nm||"",latitude:parseFloat(o.dec_lat_va)||0,longitude:parseFloat(o.dec_long_va)||0,stateCode:o.state_cd||"",countyName:o.county_nm||"",drainageAreaSqMi:o.drain_area_va?parseFloat(o.drain_area_va):null,datumElevationFt:o.alt_va?parseFloat(o.alt_va):null,siteType:o.site_tp_cd||""})}return a}e.s(["fetchFlowlines",()=>u,"fetchInstantaneousValues",()=>s,"fetchStreamGaugesByBoundingBox",()=>r,"fetchStreamGaugesByHuc",()=>n,"fetchUpstreamWatersheds",()=>l,"fetchWatershedByHuc12",()=>o,"fetchWatershedByPoint",()=>i])},43214,e=>{"use strict";var t=e.i(47909),a=e.i(74017),r=e.i(96250),n=e.i(59756),s=e.i(61916),i=e.i(14444),o=e.i(37092),l=e.i(69741),u=e.i(16795),d=e.i(87718),c=e.i(95169),p=e.i(47587),h=e.i(66012),g=e.i(70101),f=e.i(26937),m=e.i(10372),v=e.i(93695);e.i(52474);var y=e.i(220),w=e.i(89171),x=e.i(37037),R=e.i(91990);async function E(e){try{let t,{searchParams:a}=new URL(e.url),r=a.get("huc"),n=a.get("west"),s=a.get("south"),i=a.get("east"),o=a.get("north"),l="true"===a.get("readings");if(r)t=await (0,R.fetchStreamGaugesByHuc)(r);else{if(!n||!s||!i||!o)return w.NextResponse.json({error:"Either huc code or bounding box (west, south, east, north) is required"},{status:400});let e={west:parseFloat(n),south:parseFloat(s),east:parseFloat(i),north:parseFloat(o)};if(Object.values(e).some(isNaN))return w.NextResponse.json({error:"Invalid bounding box coordinates"},{status:400});t=await (0,R.fetchStreamGaugesByBoundingBox)(e.west,e.south,e.east,e.north)}let u=await (0,x.getDB)();for(let e of t)await u.prepare(`INSERT OR REPLACE INTO stream_gauges
           (site_id, site_name, latitude, longitude, state_code, county,
            drainage_area_sq_mi, datum_elevation_ft, site_type, active, cached_at)
           VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, 1, datetime('now'))`).bind(e.siteId,e.siteName,e.latitude,e.longitude,e.stateCode,e.countyName,e.drainageAreaSqMi,e.datumElevationFt,e.siteType).run();let d={};if(l&&t.length>0){let e=t.slice(0,100).map(e=>e.siteId);for(let t of(await (0,R.fetchInstantaneousValues)(e)))d[t.siteId]={timestamp:t.timestamp,dischargeCfs:t.dischargeCfs,gageHeightFt:t.gageHeightFt,waterTempCelsius:t.waterTempCelsius},await u.prepare(`INSERT OR REPLACE INTO gauge_readings
             (id, site_id, timestamp, discharge_cfs, gage_height_ft, water_temp_celsius, cached_at)
             VALUES (?, ?, ?, ?, ?, ?, datetime('now'))`).bind(`${t.siteId}_${t.timestamp}`,t.siteId,t.timestamp,t.dischargeCfs,t.gageHeightFt,t.waterTempCelsius).run()}return w.NextResponse.json({success:!0,count:t.length,gauges:t.map(e=>({siteId:e.siteId,siteName:e.siteName,latitude:e.latitude,longitude:e.longitude,stateCode:e.stateCode,county:e.countyName,drainageAreaSqMi:e.drainageAreaSqMi,datumElevationFt:e.datumElevationFt,siteType:e.siteType,latestReading:d[e.siteId]||null}))})}catch(e){return console.error("Gauges API error:",e),w.NextResponse.json({error:"Failed to fetch gauge data"},{status:500})}}e.s(["GET",()=>E],83529);var C=e.i(83529);let b=new t.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/gauges/route",pathname:"/api/gauges",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/src/app/api/gauges/route.ts",nextConfigOutput:"standalone",userland:C}),{workAsyncStorage:_,workUnitAsyncStorage:S,serverHooks:N}=b;function T(){return(0,r.patchFetch)({workAsyncStorage:_,workUnitAsyncStorage:S})}async function A(e,t,r){b.isDev&&(0,n.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let w="/api/gauges/route";w=w.replace(/\/index$/,"")||"/";let x=await b.prepare(e,t,{srcPage:w,multiZoneDraftMode:!1});if(!x)return t.statusCode=400,t.end("Bad Request"),null==r.waitUntil||r.waitUntil.call(r,Promise.resolve()),null;let{buildId:R,params:E,nextConfig:C,parsedUrl:_,isDraftMode:S,prerenderManifest:N,routerServerContext:T,isOnDemandRevalidate:A,revalidateOnlyGenerated:$,resolvedPathname:I,clientReferenceManifest:j,serverActionsManifest:O}=x,k=(0,l.normalizeAppPath)(w),F=!!(N.dynamicRoutes[k]||N.routes[I]),P=async()=>((null==T?void 0:T.render404)?await T.render404(e,t,_,!1):t.end("This page could not be found"),null);if(F&&!S){let e=!!N.routes[I],t=N.dynamicRoutes[k];if(t&&!1===t.fallback&&!e){if(C.experimental.adapterPath)return await P();throw new v.NoFallbackError}}let H=null;!F||b.isDev||S||(H="/index"===(H=I)?"/":H);let M=!0===b.isDev||!F,q=F&&!M;O&&j&&(0,i.setReferenceManifestsSingleton)({page:w,clientReferenceManifest:j,serverActionsManifest:O,serverModuleMap:(0,o.createServerModuleMap)({serverActionsManifest:O})});let U=e.method||"GET",D=(0,s.getTracer)(),G=D.getActiveScopeSpan(),B={params:E,prerenderManifest:N,renderOpts:{experimental:{authInterrupts:!!C.experimental.authInterrupts},cacheComponents:!!C.cacheComponents,supportsDynamicResponse:M,incrementalCache:(0,n.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:C.cacheLife,waitUntil:r.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,a,r)=>b.onRequestError(e,t,r,T)},sharedContext:{buildId:R}},L=new u.NodeNextRequest(e),K=new u.NodeNextResponse(t),V=d.NextRequestAdapter.fromNodeNextRequest(L,(0,d.signalFromNodeResponse)(t));try{let i=async e=>b.handle(V,B).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let a=D.getRootSpanAttributes();if(!a)return;if(a.get("next.span_type")!==c.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${a.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let r=a.get("next.route");if(r){let t=`${U} ${r}`;e.setAttributes({"next.route":r,"http.route":r,"next.span_name":t}),e.updateName(t)}else e.updateName(`${U} ${w}`)}),o=!!(0,n.getRequestMeta)(e,"minimalMode"),l=async n=>{var s,l;let u=async({previousCacheEntry:a})=>{try{if(!o&&A&&$&&!a)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let s=await i(n);e.fetchMetrics=B.renderOpts.fetchMetrics;let l=B.renderOpts.pendingWaitUntil;l&&r.waitUntil&&(r.waitUntil(l),l=void 0);let u=B.renderOpts.collectedTags;if(!F)return await (0,h.sendResponse)(L,K,s,B.renderOpts.pendingWaitUntil),null;{let e=await s.blob(),t=(0,g.toNodeOutgoingHttpHeaders)(s.headers);u&&(t[m.NEXT_CACHE_TAGS_HEADER]=u),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let a=void 0!==B.renderOpts.collectedRevalidate&&!(B.renderOpts.collectedRevalidate>=m.INFINITE_CACHE)&&B.renderOpts.collectedRevalidate,r=void 0===B.renderOpts.collectedExpire||B.renderOpts.collectedExpire>=m.INFINITE_CACHE?void 0:B.renderOpts.collectedExpire;return{value:{kind:y.CachedRouteKind.APP_ROUTE,status:s.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:a,expire:r}}}}catch(t){throw(null==a?void 0:a.isStale)&&await b.onRequestError(e,t,{routerKind:"App Router",routePath:w,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:q,isOnDemandRevalidate:A})},T),t}},d=await b.handleResponse({req:e,nextConfig:C,cacheKey:H,routeKind:a.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:N,isRoutePPREnabled:!1,isOnDemandRevalidate:A,revalidateOnlyGenerated:$,responseGenerator:u,waitUntil:r.waitUntil,isMinimalMode:o});if(!F)return null;if((null==d||null==(s=d.value)?void 0:s.kind)!==y.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==d||null==(l=d.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});o||t.setHeader("x-nextjs-cache",A?"REVALIDATED":d.isMiss?"MISS":d.isStale?"STALE":"HIT"),S&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let c=(0,g.fromNodeOutgoingHttpHeaders)(d.value.headers);return o&&F||c.delete(m.NEXT_CACHE_TAGS_HEADER),!d.cacheControl||t.getHeader("Cache-Control")||c.get("Cache-Control")||c.set("Cache-Control",(0,f.getCacheControlHeader)(d.cacheControl)),await (0,h.sendResponse)(L,K,new Response(d.value.body,{headers:c,status:d.value.status||200})),null};G?await l(G):await D.withPropagatedContext(e.headers,()=>D.trace(c.BaseServerSpan.handleRequest,{spanName:`${U} ${w}`,kind:s.SpanKind.SERVER,attributes:{"http.method":U,"http.target":e.url}},l))}catch(t){if(t instanceof v.NoFallbackError||await b.onRequestError(e,t,{routerKind:"App Router",routePath:k,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:q,isOnDemandRevalidate:A})}),F)throw t;return await (0,h.sendResponse)(L,K,new Response(null,{status:500})),null}}e.s(["handler",()=>A,"patchFetch",()=>T,"routeModule",()=>b,"serverHooks",()=>N,"workAsyncStorage",()=>_,"workUnitAsyncStorage",()=>S],43214)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__da69760f._.js.map
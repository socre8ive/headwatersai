module.exports=[70406,(e,t,r)=>{t.exports=e.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},18622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},24725,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},93695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},37037,e=>{"use strict";let t=Symbol.for("__cloudflare-context__");function r(){return globalThis[t]}async function a(){let e=r();if(e)return e;{var a;let e=await n();return a=e,globalThis[t]=a,e}}async function n(e){let{getPlatformProxy:t}=await import(`${"__wrangler".replaceAll("_","")}`),r=e?.environment??process.env.NEXT_DEV_WRANGLER_ENV,{env:a,cf:n,ctx:s}=await t({...e,envFiles:[],environment:r});return{env:a,cf:n,ctx:s}}async function s(){let{env:e}=await function(e={async:!1}){return e.async?a():function(){let e,t=r();if(t)return t;if(e=globalThis,e.__NEXT_DATA__?.nextExport===!0)throw Error("\n\nERROR: `getCloudflareContext` has been called in sync mode in either a static route or at the top level of a non-static one, both cases are not allowed but can be solved by either:\n  - make sure that the call is not at the top level and that the route is not static\n  - call `getCloudflareContext({async: true})` to use the `async` mode\n  - avoid calling `getCloudflareContext` in the route\n");throw Error('\n\nERROR: `getCloudflareContext` has been called without having called `initOpenNextCloudflareForDev` from the Next.js config file.\nYou should update your Next.js config file as shown below:\n\n   ```\n   // next.config.mjs\n\n   import { initOpenNextCloudflareForDev } from "@opennextjs/cloudflare";\n\n   initOpenNextCloudflareForDev();\n\n   const nextConfig = { ... };\n   export default nextConfig;\n   ```\n\n')}()}();return e}async function o(){return(await s()).DB}e.s(["getDB",()=>o],37037)},91990,e=>{"use strict";let t="https://waterservices.usgs.gov/nwis",r="https://hydro.nationalmap.gov/arcgis/rest/services";async function a(e,r,a,n){let s=`${e},${r},${a},${n}`,o=`${t}/site/?format=rdb&bBox=${s}&siteOutput=expanded&siteStatus=active&siteType=ST&hasDataTypeCd=iv`,i=await fetch(o);if(!i.ok)throw Error(`USGS API error: ${i.status}`);return c(await i.text())}async function n(e){let r=`${t}/site/?format=rdb&huc=${e}&siteOutput=expanded&siteStatus=active&siteType=ST&hasDataTypeCd=iv`,a=await fetch(r);if(!a.ok)throw Error(`USGS API error: ${a.status}`);return c(await a.text())}async function s(e,r=["00060","00065","00010"]){let a=e.join(","),n=r.join(","),o=`${t}/iv/?format=json&sites=${a}&parameterCd=${n}&siteStatus=all`,i=await fetch(o);if(!i.ok)throw Error(`USGS API error: ${i.status}`);return function(e){let t=new Map;if(!e.value?.timeSeries)return[];for(let r of e.value.timeSeries){let e=r.sourceInfo.siteCode[0]?.value,a=r.variable.variableCode[0]?.value;if(e&&r.values[0]?.value)for(let n of r.values[0].value){let r=`${e}_${n.dateTime}`;t.has(r)||t.set(r,{siteId:e,timestamp:n.dateTime,dischargeCfs:null,gageHeightFt:null,waterTempCelsius:null,dissolvedOxygenMgL:null,ph:null,specificConductance:null,turbidityNtu:null});let s=t.get(r),o=parseFloat(n.value);if(!isNaN(o))switch(a){case"00060":s.dischargeCfs=o;break;case"00065":s.gageHeightFt=o;break;case"00010":s.waterTempCelsius=o;break;case"00300":s.dissolvedOxygenMgL=o;break;case"00400":s.ph=o;break;case"00095":s.specificConductance=o;break;case"63680":s.turbidityNtu=o}}}return Array.from(t.values())}(await i.json())}async function o(e,t){let a=`${r}/wbd/MapServer/6/query?geometry=${t},${e}&geometryType=esriGeometryPoint&inSR=4326&spatialRel=esriSpatialRelIntersects&outFields=*&returnGeometry=true&f=geojson`,n=await fetch(a);if(!n.ok)throw Error(`USGS NHD API error: ${n.status}`);let s=await n.json();if(!s.features||0===s.features.length)return null;let o=s.features[0],i=o.properties,u=i.huc12||i.HUC12;return{huc12:u,huc10:u.substring(0,10),huc8:u.substring(0,8),huc6:u.substring(0,6),huc4:u.substring(0,4),huc2:u.substring(0,2),name:i.name||i.NAME,areaSqKm:i.areasqkm||i.AREASQKM||0,states:i.states||i.STATES||"",centroidLat:e,centroidLng:t,boundaryGeoJson:o.geometry}}async function i(e){let t=`${r}/wbd/MapServer/6/query?where=HUC12='${e}'&outFields=*&returnGeometry=true&f=geojson`,a=await fetch(t);if(!a.ok)throw Error(`USGS NHD API error: ${a.status}`);let n=await a.json();if(!n.features||0===n.features.length)return null;let s=n.features[0],o=s.properties,i=function(e){let t=0,r=0,a=0;function n(e){for(let n of e)r+=n[0],t+=n[1],a++}if("Polygon"===e.type)n(e.coordinates[0]);else if("MultiPolygon"===e.type)for(let t of e.coordinates)n(t[0]);return{lat:a>0?t/a:0,lng:a>0?r/a:0}}(s.geometry),u=o.huc12||o.HUC12;return{huc12:u,huc10:u.substring(0,10),huc8:u.substring(0,8),huc6:u.substring(0,6),huc4:u.substring(0,4),huc2:u.substring(0,2),name:o.name||o.NAME,areaSqKm:o.areasqkm||o.AREASQKM||0,states:o.states||o.STATES||"",centroidLat:i.lat,centroidLng:i.lng,boundaryGeoJson:s.geometry}}async function u(e){let t=`${r}/wbd/MapServer/6/query?where=TOHUC='${e}'&outFields=HUC12&returnGeometry=false&f=json`,a=await fetch(t);if(!a.ok)throw Error(`USGS NHD API error: ${a.status}`);return(await a.json()).features.map(e=>e.attributes.HUC12)}async function l(e,t,a,n){let s=`${e},${t},${a},${n}`,o=`${r}/nhd/MapServer/6/query?geometry=${s}&geometryType=esriGeometryEnvelope&inSR=4326&spatialRel=esriSpatialRelIntersects&outFields=GNIS_NAME,LENGTHKM,FCODE,STREAMORDE&returnGeometry=true&f=geojson`,i=await fetch(o);if(!i.ok)throw Error(`USGS NHD API error: ${i.status}`);return await i.json()}function c(e){let t=e.split("\n"),r=[],a=-1,n=[];for(let e=0;e<t.length;e++){let s=t[e].trim();if(s.startsWith("#")||""===s)continue;if(-1===a){n=s.split("	"),a=e;continue}if(s.match(/^[\d\-s]+$/))continue;let o=s.split("	"),i={};n.forEach((e,t)=>{i[e]=o[t]||""}),i.site_no&&r.push({siteId:i.site_no,siteName:i.station_nm||"",latitude:parseFloat(i.dec_lat_va)||0,longitude:parseFloat(i.dec_long_va)||0,stateCode:i.state_cd||"",countyName:i.county_nm||"",drainageAreaSqMi:i.drain_area_va?parseFloat(i.drain_area_va):null,datumElevationFt:i.alt_va?parseFloat(i.alt_va):null,siteType:i.site_tp_cd||""})}return r}e.s(["fetchFlowlines",()=>l,"fetchInstantaneousValues",()=>s,"fetchStreamGaugesByBoundingBox",()=>a,"fetchStreamGaugesByHuc",()=>n,"fetchUpstreamWatersheds",()=>u,"fetchWatershedByHuc12",()=>i,"fetchWatershedByPoint",()=>o])},9533,e=>{"use strict";var t=e.i(47909),r=e.i(74017),a=e.i(96250),n=e.i(59756),s=e.i(61916),o=e.i(14444),i=e.i(37092),u=e.i(69741),l=e.i(16795),c=e.i(87718),d=e.i(95169),p=e.i(47587),h=e.i(66012),f=e.i(70101),g=e.i(26937),m=e.i(10372),y=e.i(93695);e.i(52474);var v=e.i(220),w=e.i(89171),x=e.i(37037),R=e.i(91990);async function E(e){try{let t,{searchParams:r}=new URL(e.url),a=r.get("lat"),n=r.get("lng"),s=r.get("huc12");if(!a&&!n&&!s)return w.NextResponse.json({error:"Either lat/lng coordinates or huc12 code is required"},{status:400});if(s)t=await (0,R.fetchWatershedByHuc12)(s);else if(a&&n){let e=parseFloat(a),r=parseFloat(n);if(isNaN(e)||isNaN(r))return w.NextResponse.json({error:"Invalid coordinates"},{status:400});if(e<-90||e>90||r<-180||r>180)return w.NextResponse.json({error:"Coordinates out of range"},{status:400});t=await (0,R.fetchWatershedByPoint)(e,r)}if(!t)return w.NextResponse.json({error:"No watershed found for the given location"},{status:404});let o=await (0,R.fetchUpstreamWatersheds)(t.huc12),i=await (0,x.getDB)();return await i.prepare(`INSERT OR REPLACE INTO watersheds
         (huc12, huc10, huc8, huc6, huc4, huc2, name, area_sq_km, states,
          centroid_lat, centroid_lng, boundary_geojson, upstream_huc12s, cached_at)
         VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, datetime('now'))`).bind(t.huc12,t.huc10,t.huc8,t.huc6,t.huc4,t.huc2,t.name,t.areaSqKm,t.states,t.centroidLat,t.centroidLng,JSON.stringify(t.boundaryGeoJson),JSON.stringify(o)).run(),w.NextResponse.json({success:!0,watershed:{huc12:t.huc12,huc10:t.huc10,huc8:t.huc8,huc6:t.huc6,huc4:t.huc4,huc2:t.huc2,name:t.name,areaSqKm:t.areaSqKm,states:t.states,centroid:{lat:t.centroidLat,lng:t.centroidLng},boundary:t.boundaryGeoJson,upstreamHuc12s:o}})}catch(e){return console.error("Watershed API error:",e),w.NextResponse.json({error:"Failed to fetch watershed data"},{status:500})}}e.s(["GET",()=>E],82202);var b=e.i(82202);let S=new t.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/watershed/route",pathname:"/api/watershed",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/src/app/api/watershed/route.ts",nextConfigOutput:"standalone",userland:b}),{workAsyncStorage:C,workUnitAsyncStorage:N,serverHooks:_}=S;function A(){return(0,a.patchFetch)({workAsyncStorage:C,workUnitAsyncStorage:N})}async function T(e,t,a){S.isDev&&(0,n.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let w="/api/watershed/route";w=w.replace(/\/index$/,"")||"/";let x=await S.prepare(e,t,{srcPage:w,multiZoneDraftMode:!1});if(!x)return t.statusCode=400,t.end("Bad Request"),null==a.waitUntil||a.waitUntil.call(a,Promise.resolve()),null;let{buildId:R,params:E,nextConfig:b,parsedUrl:C,isDraftMode:N,prerenderManifest:_,routerServerContext:A,isOnDemandRevalidate:T,revalidateOnlyGenerated:$,resolvedPathname:j,clientReferenceManifest:k,serverActionsManifest:O}=x,P=(0,u.normalizeAppPath)(w),q=!!(_.dynamicRoutes[P]||_.routes[j]),H=async()=>((null==A?void 0:A.render404)?await A.render404(e,t,C,!1):t.end("This page could not be found"),null);if(q&&!N){let e=!!_.routes[j],t=_.dynamicRoutes[P];if(t&&!1===t.fallback&&!e){if(b.experimental.adapterPath)return await H();throw new y.NoFallbackError}}let U=null;!q||S.isDev||N||(U="/index"===(U=j)?"/":U);let I=!0===S.isDev||!q,M=q&&!I;O&&k&&(0,o.setReferenceManifestsSingleton)({page:w,clientReferenceManifest:k,serverActionsManifest:O,serverModuleMap:(0,i.createServerModuleMap)({serverActionsManifest:O})});let D=e.method||"GET",F=(0,s.getTracer)(),G=F.getActiveScopeSpan(),L={params:E,prerenderManifest:_,renderOpts:{experimental:{authInterrupts:!!b.experimental.authInterrupts},cacheComponents:!!b.cacheComponents,supportsDynamicResponse:I,incrementalCache:(0,n.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:b.cacheLife,waitUntil:a.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,a)=>S.onRequestError(e,t,a,A)},sharedContext:{buildId:R}},B=new l.NodeNextRequest(e),K=new l.NodeNextResponse(t),W=c.NextRequestAdapter.fromNodeNextRequest(B,(0,c.signalFromNodeResponse)(t));try{let o=async e=>S.handle(W,L).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=F.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==d.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let a=r.get("next.route");if(a){let t=`${D} ${a}`;e.setAttributes({"next.route":a,"http.route":a,"next.span_name":t}),e.updateName(t)}else e.updateName(`${D} ${w}`)}),i=!!(0,n.getRequestMeta)(e,"minimalMode"),u=async n=>{var s,u;let l=async({previousCacheEntry:r})=>{try{if(!i&&T&&$&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let s=await o(n);e.fetchMetrics=L.renderOpts.fetchMetrics;let u=L.renderOpts.pendingWaitUntil;u&&a.waitUntil&&(a.waitUntil(u),u=void 0);let l=L.renderOpts.collectedTags;if(!q)return await (0,h.sendResponse)(B,K,s,L.renderOpts.pendingWaitUntil),null;{let e=await s.blob(),t=(0,f.toNodeOutgoingHttpHeaders)(s.headers);l&&(t[m.NEXT_CACHE_TAGS_HEADER]=l),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==L.renderOpts.collectedRevalidate&&!(L.renderOpts.collectedRevalidate>=m.INFINITE_CACHE)&&L.renderOpts.collectedRevalidate,a=void 0===L.renderOpts.collectedExpire||L.renderOpts.collectedExpire>=m.INFINITE_CACHE?void 0:L.renderOpts.collectedExpire;return{value:{kind:v.CachedRouteKind.APP_ROUTE,status:s.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:a}}}}catch(t){throw(null==r?void 0:r.isStale)&&await S.onRequestError(e,t,{routerKind:"App Router",routePath:w,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:M,isOnDemandRevalidate:T})},A),t}},c=await S.handleResponse({req:e,nextConfig:b,cacheKey:U,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:_,isRoutePPREnabled:!1,isOnDemandRevalidate:T,revalidateOnlyGenerated:$,responseGenerator:l,waitUntil:a.waitUntil,isMinimalMode:i});if(!q)return null;if((null==c||null==(s=c.value)?void 0:s.kind)!==v.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==c||null==(u=c.value)?void 0:u.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});i||t.setHeader("x-nextjs-cache",T?"REVALIDATED":c.isMiss?"MISS":c.isStale?"STALE":"HIT"),N&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let d=(0,f.fromNodeOutgoingHttpHeaders)(c.value.headers);return i&&q||d.delete(m.NEXT_CACHE_TAGS_HEADER),!c.cacheControl||t.getHeader("Cache-Control")||d.get("Cache-Control")||d.set("Cache-Control",(0,g.getCacheControlHeader)(c.cacheControl)),await (0,h.sendResponse)(B,K,new Response(c.value.body,{headers:d,status:c.value.status||200})),null};G?await u(G):await F.withPropagatedContext(e.headers,()=>F.trace(d.BaseServerSpan.handleRequest,{spanName:`${D} ${w}`,kind:s.SpanKind.SERVER,attributes:{"http.method":D,"http.target":e.url}},u))}catch(t){if(t instanceof y.NoFallbackError||await S.onRequestError(e,t,{routerKind:"App Router",routePath:P,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:M,isOnDemandRevalidate:T})}),q)throw t;return await (0,h.sendResponse)(B,K,new Response(null,{status:500})),null}}e.s(["handler",()=>T,"patchFetch",()=>A,"routeModule",()=>S,"serverHooks",()=>_,"workAsyncStorage",()=>C,"workUnitAsyncStorage",()=>N],9533)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__acf41642._.js.map
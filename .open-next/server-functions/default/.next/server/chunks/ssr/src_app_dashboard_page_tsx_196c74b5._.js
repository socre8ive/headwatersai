module.exports=[49846,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(38246);function f(){var a;let f,g=(0,d.useRouter)(),[h,i]=(0,c.useState)(null),[j,k]=(0,c.useState)([]),[l,m]=(0,c.useState)([]),[n,o]=(0,c.useState)(!0),[p,q]=(0,c.useState)("locations");(0,c.useEffect)(()=>{(async()=>{try{let a=await fetch("/api/auth/me");if(!a.ok)return void g.push("/login");let b=await a.json();i(b.user);let c=await fetch("/api/locations");if(c.ok){let a=await c.json();k(a.locations)}if("free"!==b.user.subscriptionTier){let a=await fetch("/api/alerts");if(a.ok){let b=await a.json();m(b.alerts)}}}catch(a){console.error("Failed to fetch dashboard data:",a)}finally{o(!1)}})()},[g]);let r=async a=>{if(confirm("Are you sure you want to delete this location?"))try{(await fetch(`/api/locations?id=${a}`,{method:"DELETE"})).ok&&k(j.filter(b=>b.id!==a))}catch(a){console.error("Failed to delete location:",a)}},s=async(a,b)=>{try{(await fetch("/api/alerts",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:a,active:!b})})).ok&&m(l.map(c=>c.id===a?{...c,active:!b}:c))}catch(a){console.error("Failed to toggle alert:",a)}},t=async a=>{if(confirm("Are you sure you want to delete this alert?"))try{(await fetch(`/api/alerts?id=${a}`,{method:"DELETE"})).ok&&m(l.filter(b=>b.id!==a))}catch(a){console.error("Failed to delete alert:",a)}};if(n)return(0,b.jsx)("div",{className:"min-h-[calc(100vh-4rem)] bg-gray-50 flex items-center justify-center",children:(0,b.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})});if(!h)return null;let u=(a=h.subscriptionTier,(f={free:{color:"bg-gray-100 text-gray-800",maxLocations:3,hasAlerts:!1},enthusiast:{color:"bg-green-100 text-green-800",maxLocations:10,hasAlerts:!0},professional:{color:"bg-blue-100 text-blue-800",maxLocations:100,hasAlerts:!0},enterprise:{color:"bg-purple-100 text-purple-800",maxLocations:1e3,hasAlerts:!0}})[a]||f.free);return(0,b.jsx)("div",{className:"min-h-[calc(100vh-4rem)] bg-gray-50 py-8",children:(0,b.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,b.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden mb-8",children:[(0,b.jsx)("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 px-8 py-6",children:(0,b.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h1",{className:"text-2xl font-bold text-white",children:["Welcome back, ",h.fullName||h.email.split("@")[0]]}),(0,b.jsx)("p",{className:"text-blue-100 mt-1",children:"Manage your saved locations and alerts"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium capitalize ${u.color}`,children:[h.subscriptionTier," Plan"]}),"free"===h.subscriptionTier&&(0,b.jsx)(e.default,{href:"/pricing",className:"inline-flex items-center px-4 py-2 bg-white text-blue-600 rounded-lg font-medium hover:bg-blue-50 transition-colors",children:"Upgrade"})]})]})}),(0,b.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 divide-x divide-gray-200 border-b border-gray-200",children:[(0,b.jsxs)("div",{className:"px-6 py-4 text-center",children:[(0,b.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:j.length}),(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"Saved Locations"})]}),(0,b.jsxs)("div",{className:"px-6 py-4 text-center",children:[(0,b.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:u.maxLocations}),(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"Location Limit"})]}),(0,b.jsxs)("div",{className:"px-6 py-4 text-center",children:[(0,b.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:l.length}),(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"Active Alerts"})]}),(0,b.jsxs)("div",{className:"px-6 py-4 text-center",children:[(0,b.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:new Date(h.createdAt).toLocaleDateString("en-US",{month:"short",year:"numeric"})}),(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"Member Since"})]})]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden",children:[(0,b.jsx)("div",{className:"border-b border-gray-200",children:(0,b.jsxs)("div",{className:"flex",children:[(0,b.jsxs)("button",{onClick:()=>q("locations"),className:`flex-1 px-6 py-4 text-sm font-medium transition-colors ${"locations"===p?"text-blue-600 border-b-2 border-blue-600 bg-blue-50":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,children:["ðŸ“ Saved Locations (",j.length,")"]}),(0,b.jsxs)("button",{onClick:()=>q("alerts"),disabled:!u.hasAlerts,className:`flex-1 px-6 py-4 text-sm font-medium transition-colors ${"alerts"===p?"text-blue-600 border-b-2 border-blue-600 bg-blue-50":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"} ${!u.hasAlerts?"opacity-50 cursor-not-allowed":""}`,children:["ðŸ”” Alerts (",l.length,")",!u.hasAlerts&&(0,b.jsx)("span",{className:"ml-2 text-xs bg-gray-200 text-gray-600 px-2 py-0.5 rounded",children:"Upgrade"})]})]})}),(0,b.jsxs)("div",{className:"p-6",children:["locations"===p&&(0,b.jsx)(b.Fragment,{children:0===j.length?(0,b.jsxs)("div",{className:"text-center py-12",children:[(0,b.jsxs)("svg",{className:"w-16 h-16 mx-auto text-gray-300 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No saved locations"}),(0,b.jsx)("p",{className:"text-gray-500 mb-6",children:"Start by exploring the map and saving locations you want to monitor."}),(0,b.jsx)(e.default,{href:"/explore",className:"inline-flex items-center px-6 py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors",children:"Explore the Map"})]}):(0,b.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:j.map(a=>(0,b.jsxs)("div",{className:"border border-gray-200 rounded-xl p-4 hover:border-blue-300 hover:shadow-md transition-all",children:[(0,b.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,b.jsx)("h3",{className:"font-semibold text-gray-900 truncate flex-1",children:a.name}),(0,b.jsx)("button",{onClick:()=>r(a.id),className:"text-gray-400 hover:text-red-500 transition-colors ml-2",children:(0,b.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),a.address&&(0,b.jsx)("p",{className:"text-sm text-gray-500 mb-2 truncate",children:a.address}),(0,b.jsxs)("p",{className:"text-xs text-gray-400 font-mono mb-3",children:[a.latitude.toFixed(4),"Â°, ",a.longitude.toFixed(4),"Â°"]}),a.watershedHuc12&&(0,b.jsxs)("p",{className:"text-xs text-blue-600 mb-3",children:["HUC-12: ",a.watershedHuc12]}),(0,b.jsxs)(e.default,{href:`/explore?lat=${a.latitude}&lng=${a.longitude}`,className:"inline-flex items-center text-sm text-blue-600 hover:text-blue-700 font-medium",children:["View on Map",(0,b.jsx)("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]},a.id))})}),"alerts"===p&&u.hasAlerts&&(0,b.jsx)(b.Fragment,{children:0===l.length?(0,b.jsxs)("div",{className:"text-center py-12",children:[(0,b.jsx)("svg",{className:"w-16 h-16 mx-auto text-gray-300 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No alerts configured"}),(0,b.jsx)("p",{className:"text-gray-500 mb-6",children:"Set up alerts to get notified about floods, low flow, and water quality issues."})]}):(0,b.jsx)("div",{className:"space-y-4",children:l.map(a=>{var c;return(0,b.jsx)("div",{className:`border rounded-xl p-4 ${a.active?"border-green-200 bg-green-50":"border-gray-200 bg-gray-50"}`,children:(0,b.jsxs)("div",{className:"flex justify-between items-start",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,b.jsx)("span",{className:"font-medium text-gray-900",children:{flood:"ðŸŒŠ Flood Warning",low_flow:"ðŸ’§ Low Flow",water_quality:"ðŸ§ª Water Quality",contamination:"â˜¢ï¸ Contamination"}[c=a.alertType]||c}),(0,b.jsx)("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${a.active?"bg-green-100 text-green-800":"bg-gray-200 text-gray-600"}`,children:a.active?"Active":"Paused"})]}),a.locationName&&(0,b.jsxs)("p",{className:"text-sm text-gray-600",children:["ðŸ“ ",a.locationName]}),a.thresholdValue&&(0,b.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:["Threshold: ",a.thresholdValue," ",a.thresholdUnit]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("button",{onClick:()=>s(a.id,a.active),className:`p-2 rounded-lg transition-colors ${a.active?"bg-green-100 text-green-600 hover:bg-green-200":"bg-gray-200 text-gray-600 hover:bg-gray-300"}`,children:a.active?(0,b.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z"})}):(0,b.jsxs)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]})}),(0,b.jsx)("button",{onClick:()=>t(a.id),className:"p-2 rounded-lg bg-red-100 text-red-600 hover:bg-red-200 transition-colors",children:(0,b.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})},a.id)})})})]})]})]})})}a.s(["default",()=>f])}];

//# sourceMappingURL=src_app_dashboard_page_tsx_196c74b5._.js.map
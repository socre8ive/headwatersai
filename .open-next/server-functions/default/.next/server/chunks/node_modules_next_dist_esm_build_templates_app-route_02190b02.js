module.exports=[74586,e=>{"use strict";var t=e.i(47909),r=e.i(74017),a=e.i(96250),i=e.i(59756),o=e.i(61916),n=e.i(14444),s=e.i(37092),l=e.i(69741),p=e.i(16795),c=e.i(87718),u=e.i(95169),d=e.i(47587),h=e.i(66012),m=e.i(70101),w=e.i(26937),f=e.i(10372),g=e.i(93695);e.i(52474);var v=e.i(220),y=e.i(89171);let A="https://api.weather.gov";async function R(e,t){let r=`${A}/points/${e.toFixed(4)},${t.toFixed(4)}`,a=await fetch(r,{headers:{"User-Agent":"HeadwatersAI (contact@headwatersai.com)",Accept:"application/geo+json"}});if(!a.ok)throw Error(`NOAA API error: ${a.status}`);let i=(await a.json()).properties;return{gridId:i.gridId,gridX:i.gridX,gridY:i.gridY,forecastUrl:i.forecast,forecastHourlyUrl:i.forecastHourly,radarStation:i.radarStation,timeZone:i.timeZone,county:i.county?.split("/").pop()||"",state:i.relativeLocation?.properties?.state||""}}async function E(e,t){let r=await R(e,t),a=await fetch(r.forecastUrl,{headers:{"User-Agent":"HeadwatersAI (contact@headwatersai.com)",Accept:"application/geo+json"}});if(!a.ok)throw Error(`NOAA Forecast API error: ${a.status}`);let i=await a.json();return{updated:i.properties.updated,periods:i.properties.periods.map(e=>({number:e.number,name:e.name,startTime:e.startTime,endTime:e.endTime,isDaytime:e.isDaytime,temperature:e.temperature,temperatureUnit:e.temperatureUnit,temperatureTrend:e.temperatureTrend,probabilityOfPrecipitation:e.probabilityOfPrecipitation?.value??null,windSpeed:e.windSpeed,windDirection:e.windDirection,shortForecast:e.shortForecast,detailedForecast:e.detailedForecast,icon:e.icon}))}}async function N(e,t){let r=await R(e,t),a=await fetch(r.forecastHourlyUrl,{headers:{"User-Agent":"HeadwatersAI (contact@headwatersai.com)",Accept:"application/geo+json"}});if(!a.ok)throw Error(`NOAA Hourly Forecast API error: ${a.status}`);let i=await a.json();return{updated:i.properties.updated,periods:i.properties.periods.map(e=>({number:e.number,name:e.name,startTime:e.startTime,endTime:e.endTime,isDaytime:e.isDaytime,temperature:e.temperature,temperatureUnit:e.temperatureUnit,temperatureTrend:e.temperatureTrend,probabilityOfPrecipitation:e.probabilityOfPrecipitation?.value??null,windSpeed:e.windSpeed,windDirection:e.windDirection,shortForecast:e.shortForecast,detailedForecast:e.detailedForecast,icon:e.icon}))}}async function x(e,t){let r=`${A}/alerts/active?point=${e.toFixed(4)},${t.toFixed(4)}`,a=await fetch(r,{headers:{"User-Agent":"HeadwatersAI (contact@headwatersai.com)",Accept:"application/geo+json"}});if(!a.ok)throw Error(`NOAA Alerts API error: ${a.status}`);return(await a.json()).features.map(e=>({id:e.properties.id,areaDesc:e.properties.areaDesc,severity:e.properties.severity,certainty:e.properties.certainty,urgency:e.properties.urgency,event:e.properties.event,headline:e.properties.headline||"",description:e.properties.description||"",instruction:e.properties.instruction,onset:e.properties.onset,expires:e.properties.expires,senderName:e.properties.senderName}))}async function T(e,t,r=50){let a=await R(e,t),i=`${A}/gridpoints/${a.gridId}/${a.gridX},${a.gridY}/stations`,o=await fetch(i,{headers:{"User-Agent":"HeadwatersAI (contact@headwatersai.com)",Accept:"application/geo+json"}});if(!o.ok)throw Error(`NOAA Stations API error: ${o.status}`);return(await o.json()).features.filter(a=>{var i,o,n,s;let l,p,c,u=a.geometry.coordinates;return i=e,o=t,n=u[1],s=u[0],l=C(n-i),p=C(s-o),2*Math.atan2(Math.sqrt(c=Math.sin(l/2)*Math.sin(l/2)+Math.cos(C(i))*Math.cos(C(n))*Math.sin(p/2)*Math.sin(p/2)),Math.sqrt(1-c))*6371<=r}).map(e=>({stationId:e.properties.stationIdentifier,name:e.properties.name,latitude:e.geometry.coordinates[1],longitude:e.geometry.coordinates[0],elevation:e.properties.elevation?.value||0,stationType:e.properties.stationType||"Unknown"}))}async function b(e){let t=`${A}/stations/${e}/observations/latest`,r=await fetch(t,{headers:{"User-Agent":"HeadwatersAI (contact@headwatersai.com)",Accept:"application/geo+json"}});if(!r.ok){if(404===r.status)return null;throw Error(`NOAA Observation API error: ${r.status}`)}let a=await r.json(),i=a.properties,o=a.geometry?.coordinates||[0,0];return{stationId:e,stationName:i.station?.split("/").pop()||e,latitude:o[1],longitude:o[0],observationTime:i.timestamp,precipitationLastHour:i.precipitationLastHour?.value??null,precipitationLast3Hours:i.precipitationLast3Hours?.value??null,precipitationLast6Hours:i.precipitationLast6Hours?.value??null,precipitationLast24Hours:i.precipitationLast24Hours?.value??null,temperature:i.temperature?.value??null,humidity:i.relativeHumidity?.value??null}}async function I(e,t,r=50){let a=await T(e,t,r),i=[];for(let e of a.slice(0,10))try{let t=await b(e.stationId);t&&(t.stationName=e.name,t.latitude=e.latitude,t.longitude=e.longitude,i.push(t))}catch{continue}return i}async function P(e,t){let r=await R(e,t),a=`${A}/gridpoints/${r.gridId}/${r.gridX},${r.gridY}`,i=await fetch(a,{headers:{"User-Agent":"HeadwatersAI (contact@headwatersai.com)",Accept:"application/geo+json"}});if(!i.ok)throw Error(`NOAA Gridpoint API error: ${i.status}`);let o=(await i.json()).properties.quantitativePrecipitation;return o?.values?o.values.map(e=>({validTime:e.validTime.split("/")[0],duration:e.validTime.split("/")[1]||"PT1H",precipitationMm:e.value??0,precipitationIn:(e.value??0)/25.4})):[]}function C(e){return Math.PI/180*e}async function H(e){try{let t,{searchParams:r}=new URL(e.url),a=r.get("lat"),i=r.get("lng"),o=r.get("type")||"forecast";if(!a||!i)return y.NextResponse.json({error:"Latitude and longitude are required"},{status:400});let n=parseFloat(a),s=parseFloat(i);if(isNaN(n)||isNaN(s))return y.NextResponse.json({error:"Invalid coordinates"},{status:400});if(n<24||n>50||s<-125||s>-66)return y.NextResponse.json({error:"Coordinates must be within the continental United States"},{status:400});switch(o){case"forecast":return t=await E(n,s),y.NextResponse.json({success:!0,type:"forecast",location:{lat:n,lng:s},forecast:t});case"hourly":return t=await N(n,s),y.NextResponse.json({success:!0,type:"hourly",location:{lat:n,lng:s},forecast:t});case"alerts":return t=await x(n,s),y.NextResponse.json({success:!0,type:"alerts",location:{lat:n,lng:s},alertCount:t.length,alerts:t});case"precipitation":return t=await P(n,s),y.NextResponse.json({success:!0,type:"precipitation",location:{lat:n,lng:s},precipitationForecast:t});case"observations":let l=r.get("radius")?parseFloat(r.get("radius")):50;return t=await I(n,s,l),y.NextResponse.json({success:!0,type:"observations",location:{lat:n,lng:s},radiusKm:l,stationCount:t.length,observations:t});case"all":let[p,c,u,d,h]=await Promise.all([E(n,s),N(n,s),x(n,s),P(n,s),I(n,s,50)]);return y.NextResponse.json({success:!0,type:"all",location:{lat:n,lng:s},forecast:p,hourlyForecast:c,alerts:u,precipitationForecast:d,observations:h});default:return y.NextResponse.json({error:"Invalid type. Must be: forecast, hourly, alerts, precipitation, observations, or all"},{status:400})}}catch(e){return console.error("Weather API error:",e),y.NextResponse.json({error:"Failed to fetch weather data"},{status:500})}}e.s(["GET",()=>H],51133);var U=e.i(51133);let O=new t.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/weather/route",pathname:"/api/weather",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/src/app/api/weather/route.ts",nextConfigOutput:"standalone",userland:U}),{workAsyncStorage:j,workUnitAsyncStorage:$,serverHooks:F}=O;function M(){return(0,a.patchFetch)({workAsyncStorage:j,workUnitAsyncStorage:$})}async function S(e,t,a){O.isDev&&(0,i.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let y="/api/weather/route";y=y.replace(/\/index$/,"")||"/";let A=await O.prepare(e,t,{srcPage:y,multiZoneDraftMode:!1});if(!A)return t.statusCode=400,t.end("Bad Request"),null==a.waitUntil||a.waitUntil.call(a,Promise.resolve()),null;let{buildId:R,params:E,nextConfig:N,parsedUrl:x,isDraftMode:T,prerenderManifest:b,routerServerContext:I,isOnDemandRevalidate:P,revalidateOnlyGenerated:C,resolvedPathname:H,clientReferenceManifest:U,serverActionsManifest:j}=A,$=(0,l.normalizeAppPath)(y),F=!!(b.dynamicRoutes[$]||b.routes[H]),M=async()=>((null==I?void 0:I.render404)?await I.render404(e,t,x,!1):t.end("This page could not be found"),null);if(F&&!T){let e=!!b.routes[H],t=b.dynamicRoutes[$];if(t&&!1===t.fallback&&!e){if(N.experimental.adapterPath)return await M();throw new g.NoFallbackError}}let S=null;!F||O.isDev||T||(S="/index"===(S=H)?"/":S);let D=!0===O.isDev||!F,k=F&&!D;j&&U&&(0,n.setReferenceManifestsSingleton)({page:y,clientReferenceManifest:U,serverActionsManifest:j,serverModuleMap:(0,s.createServerModuleMap)({serverActionsManifest:j})});let _=e.method||"GET",q=(0,o.getTracer)(),L=q.getActiveScopeSpan(),K={params:E,prerenderManifest:b,renderOpts:{experimental:{authInterrupts:!!N.experimental.authInterrupts},cacheComponents:!!N.cacheComponents,supportsDynamicResponse:D,incrementalCache:(0,i.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:N.cacheLife,waitUntil:a.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,a)=>O.onRequestError(e,t,a,I)},sharedContext:{buildId:R}},X=new p.NodeNextRequest(e),B=new p.NodeNextResponse(t),G=c.NextRequestAdapter.fromNodeNextRequest(X,(0,c.signalFromNodeResponse)(t));try{let n=async e=>O.handle(G,K).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=q.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==u.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let a=r.get("next.route");if(a){let t=`${_} ${a}`;e.setAttributes({"next.route":a,"http.route":a,"next.span_name":t}),e.updateName(t)}else e.updateName(`${_} ${y}`)}),s=!!(0,i.getRequestMeta)(e,"minimalMode"),l=async i=>{var o,l;let p=async({previousCacheEntry:r})=>{try{if(!s&&P&&C&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let o=await n(i);e.fetchMetrics=K.renderOpts.fetchMetrics;let l=K.renderOpts.pendingWaitUntil;l&&a.waitUntil&&(a.waitUntil(l),l=void 0);let p=K.renderOpts.collectedTags;if(!F)return await (0,h.sendResponse)(X,B,o,K.renderOpts.pendingWaitUntil),null;{let e=await o.blob(),t=(0,m.toNodeOutgoingHttpHeaders)(o.headers);p&&(t[f.NEXT_CACHE_TAGS_HEADER]=p),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==K.renderOpts.collectedRevalidate&&!(K.renderOpts.collectedRevalidate>=f.INFINITE_CACHE)&&K.renderOpts.collectedRevalidate,a=void 0===K.renderOpts.collectedExpire||K.renderOpts.collectedExpire>=f.INFINITE_CACHE?void 0:K.renderOpts.collectedExpire;return{value:{kind:v.CachedRouteKind.APP_ROUTE,status:o.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:a}}}}catch(t){throw(null==r?void 0:r.isStale)&&await O.onRequestError(e,t,{routerKind:"App Router",routePath:y,routeType:"route",revalidateReason:(0,d.getRevalidateReason)({isStaticGeneration:k,isOnDemandRevalidate:P})},I),t}},c=await O.handleResponse({req:e,nextConfig:N,cacheKey:S,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:b,isRoutePPREnabled:!1,isOnDemandRevalidate:P,revalidateOnlyGenerated:C,responseGenerator:p,waitUntil:a.waitUntil,isMinimalMode:s});if(!F)return null;if((null==c||null==(o=c.value)?void 0:o.kind)!==v.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==c||null==(l=c.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});s||t.setHeader("x-nextjs-cache",P?"REVALIDATED":c.isMiss?"MISS":c.isStale?"STALE":"HIT"),T&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let u=(0,m.fromNodeOutgoingHttpHeaders)(c.value.headers);return s&&F||u.delete(f.NEXT_CACHE_TAGS_HEADER),!c.cacheControl||t.getHeader("Cache-Control")||u.get("Cache-Control")||u.set("Cache-Control",(0,w.getCacheControlHeader)(c.cacheControl)),await (0,h.sendResponse)(X,B,new Response(c.value.body,{headers:u,status:c.value.status||200})),null};L?await l(L):await q.withPropagatedContext(e.headers,()=>q.trace(u.BaseServerSpan.handleRequest,{spanName:`${_} ${y}`,kind:o.SpanKind.SERVER,attributes:{"http.method":_,"http.target":e.url}},l))}catch(t){if(t instanceof g.NoFallbackError||await O.onRequestError(e,t,{routerKind:"App Router",routePath:$,routeType:"route",revalidateReason:(0,d.getRevalidateReason)({isStaticGeneration:k,isOnDemandRevalidate:P})}),F)throw t;return await (0,h.sendResponse)(X,B,new Response(null,{status:500})),null}}e.s(["handler",()=>S,"patchFetch",()=>M,"routeModule",()=>O,"serverHooks",()=>F,"workAsyncStorage",()=>j,"workUnitAsyncStorage",()=>$],74586)}];

//# sourceMappingURL=node_modules_next_dist_esm_build_templates_app-route_02190b02.js.map